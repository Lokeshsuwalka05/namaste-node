# ğŸ“˜ MongoDB + Mongoose + Express Setup

This guide explains how to **connect MongoDB with Node.js (Express)** using **Mongoose**, and create a simple **signup API**.

## ğŸ”Œ Why Always Use Mongoose?

- Mongoose is an **ODM (Object Data Modeling) library** for MongoDB.
- It gives you a **structured way** to define schema and interact with the database.
- Provides validation, middlewares, and a clean syntax compared to raw MongoDB driver.

## âš ï¸ Connect DB Before Starting Server

ğŸ‘‰ **Rule:** Always connect your database **first**, then start listening to the server.

âŒ Problem if you don't:

- If DB is not connected and server is already running:
  - API requests (like `/signup`) will fail.
  - You may get errors like `MongoNotConnectedError`.
  - Users won't be able to store/fetch data.
  - Basically â†’ server chal raha hai but data ka gate hi closed hai ğŸšª.

## ğŸ—ï¸ Schema & Model

- **Schema** â†’ Blueprint (what fields you want in your document).
- **Model** â†’ Constructor based on schema, used to interact with DB.

Example:

```javascript
const mongoose = require("mongoose");

// User Schema
const userSchema = new mongoose.Schema({
  firstName: { type: String, required: true },
  lastName: String,
  emailId: { type: String, required: true, unique: true },
  password: { type: String, required: true },
  age: Number,
});

// User Model
const User = mongoose.model("User", userSchema);

module.exports = { User };
```

## ğŸš€ Creating Express Server + MongoDB Connection

```javascript
const express = require("express");
const mongoose = require("mongoose");
const { User } = require("./models/user");

const app = express();
app.use(express.json()); // Middleware for JSON parsing

// DB Connection
mongoose
  .connect("mongodb://localhost:27017/mydb")
  .then(() => {
    console.log("âœ… Database Connected");
    app.listen(3000, () => {
      console.log("ğŸš€ Server is running on port 3000");
    });
  })
  .catch((err) => {
    console.error("âŒ DB Connection Failed:", err);
  });
```

## âœ¨ Signup API (POST /signup)

```javascript
app.post("/signup", async (req, res) => {
  try {
    const { firstName, lastName, emailId, password, age } = req.body;

    // Create instance of User model
    const user = new User({ firstName, lastName, emailId, password, age });

    // Save to DB
    await user.save();

    res.status(201).send("ğŸ‰ User Registered Successfully!");
  } catch (err) {
    console.error(err);
    res.status(500).send("âŒ Something went wrong");
  }
});
```

## ğŸ“¬ Testing with Postman

1. Run your server.
2. Open Postman â†’ `POST http://localhost:3000/signup`.
3. Send JSON body:

```json
{
  "firstName": "Maya",
  "lastName": "Sharma",
  "emailId": "maya@gmail.com",
  "password": "123",
  "age": 25
}
```

4. âœ… Check MongoDB, document will be inserted.

## ğŸ› ï¸ Flow of Adding a User

`UserSchema â†’ UserModel â†’ Create Instance â†’ Save to DB`

Think of it like ğŸ‘‡

- **Schema** = Form design ğŸ“
- **Model** = Printing that form ğŸ“„
- **Instance** = Filling the form âœï¸
- **Save()** = Submitting form to office ğŸ“‚
